{
  "pluginType": "DB",
  "pluginId": "mysql-plugin",
  "unpublishedAction": {
    "name": "Sales_Select",
    "datasource": {
      "name": "appsmithmysql",
      "pluginId": "mysql-plugin",
      "messages": [],
      "isAutoGenerated": false,
      "id": "appsmithmysql",
      "deleted": false,
      "policies": [],
      "userPermissions": []
    },
    "pageId": "Sales",
    "actionConfiguration": {
      "timeoutInMillisecond": 10000,
      "paginationType": "NONE",
      "encodeParamsToggle": true,
      "body": "SELECT \n    Sales.Id as SalesId, Sales.Number, Sales.Description,\n    Sales.ClientId, Sales.CompanyId,\n    Sales.CurrentState, Sales.BusinessUnitId,\n    Client.Name AS Client, \n    BusinessUnit.Name AS BusinessUnit,\n    SalesManager.Id AS SalesManagerId,\n    SalesManager.UserName AS SalesManager,\n    BusinessManager.Id AS BusinessManagerId,\n    BusinessManager.UserName AS BusinessManager\nFROM Sales \nLEFT JOIN Client ON Sales.ClientId = Client.Id\nINNER JOIN BusinessUnit ON Sales.BusinessUnitId = BusinessUnit.Id\nLEFT JOIN AppUser AS SalesManager ON Sales.SalesManagerId = SalesManager.Id\nLEFT JOIN AppUser AS BusinessManager ON Sales.BusinessManagerId = BusinessManager.Id\nLEFT JOIN UserRole ON SalesManager.Id = UserRole.UserId  \nLEFT JOIN Role ON UserRole.RoleId = Role.Id\nWHERE \n    Role.Name = 'Sales Manager'\n    AND (\n        (\n            '{{appsmith.store.FilterRole}}' = 'BusinessManager'\n            AND BusinessManager.UserName = '{{appsmith.user.username.split('@')[0]}}'\n        )\n        OR\n        '{{appsmith.store.FilterRole}}' = 'SalesManager'\n    )\n    AND Sales.CurrentState = '{{ appsmith.store?.currentStateName || 'Lead' }}'\n    AND {{ this.params?.ClientFilter || true }}\n    AND {{ this.params?.SalesManagerFilter || true }} \n    AND Sales.Deleted = 0 \nORDER BY Sales.Id DESC;",
      "selfReferencingDataPaths": [],
      "pluginSpecifiedTemplates": [
        {
          "value": false
        }
      ]
    },
    "executeOnLoad": true,
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "isValid": true,
    "invalids": [],
    "messages": [],
    "jsonPathKeys": [
      " appsmith.store?.currentStateName || 'Lead' ",
      " this.params?.ClientFilter || true ",
      " this.params?.SalesManagerFilter || true ",
      "appsmith.store.FilterRole",
      "appsmith.user.username.split('@')[0]"
    ],
    "userSetOnLoad": false,
    "confirmBeforeExecute": false,
    "policies": [],
    "userPermissions": [],
    "createdAt": "2024-04-25T09:02:08Z"
  },
  "id": "Sales_Sales_Select",
  "deleted": false,
  "gitSyncId": "63e5d847e80cbd4992442eae_63e5d849e80cbd4992442f20"
}